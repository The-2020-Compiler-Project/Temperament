# 个人进展

## 	文法设计：

目前按照实例上的文法进行设计：

##### ·程序定义:

<程序>→program <标识符> <分程序>.

<分程序>→<变量说明> <复合语句>

##### ·语句定义:

<变量说明>→var <标识符表> ：<类型> ；

<标识符表>→<标识符> ，<标识符表> | <标识符>

<复合语句>→begin <语句表> end

<语句表>→<赋值语句> ；<语句表> | <赋值语句>

<赋值语句>→<标识符> := <算术表达式>

##### ·算术表达式定义:

<算术表达式>→<算术表达式> ω0 <项> | <项>

<项>→<项> ω1 <因子> | <因子>

<因子>→<算术量> | ( <算术表达式> )

<算术量>→<标识符> | <常数> 

##### ·类型定义:

<类型>→integer | real | char

##### ·单词集定义:

<标识符>→<字母> | <标识符> <数字> | <标识符> <字母>

<常数>→<整数> | <实数>

<整数>→<数字> | <整数> <数字>

<实数>→<整数> . <整数>

##### ·字符集定义

<字母>→A|B|C|…|Z|a|b|c|…|z

<数字>→0|1|2|3|4|5|6|7|8|9

 其中：ω0 — +或-

​    ω1 — *或/

在完成基础内容的情况下，后期会考虑添加if-else语句和while语句作为扩展，而这两种语句的动作函数会相对来说更加复杂。



## 	数据结构：

#####        四元式结构体：

```
struct quad
{
	char op[20];
	char ag1[20];
	char ag2[20];
	char res[20];
}quad[100];
```

#####        语义分析器类：

```
class yuyi
{
public:
    int doit();
    int scaner();
    int fanyi();
    int fuzhi();
    int jieshu();
    char *program();
    char *chengchu();
    char *judge();
    char *jiajian();
    char * new();
    void four(char* op,char* ag1,char* ag2,char* res);
private:
    char prog[100],token[20],ch,k;
    int syn,p,m,n,s,a,N,t;
    int b=0,c=0,k=0,i=0;
    char* key[7] = {"begin","program","var","real","integer","char","end"};
};
```



## 	系统架构：

1、语义分析器采用递归下降的语法制导翻译法，对program整体结构，算术表达式，赋值语句进行语义分析并生成四元式序列，输出到文件中为中间代码优化的同学读取。

2、输入的是需要识别的源程序,输出的是固定结构的四元式序列。

3、将语义分析器整体合为一个类，关键字为七个"program","var","integer","real","char","begin","end"，当然"var"以及三个数据类型关键字并不需要插入语义动作。

4、扫描器函数的功能是每次读入一个单词，并判断其类型序号。

5、翻译函数的功能是在语法分析的基础上插入相应的语义动作，并将输入程序逐步翻译为四元式序列。

6、整个程序的结束是当读入“end”与前面的“begin”匹配并读到“#”时，程序就停止。



##     测试数据：

#####   源程序：

```
program example 

​	var a，b ：integer ; 

​	begin 

​		a:=2 ;

​		b:=2*5+a ;  

​	end#
```

#####   输出结果：

```
( program , example , _ , _ )
( := , 2 , _ , a )
( * , 2 , 5 , t1 )
( + , t1 , a , t2 )
( := , t2 , _ , b )
( end , example , _ , _ )
```



# 问题

目前语义分析器还存在一些不足：

1、报错机制不是很完整，对于有些错误只是会输不出结果但没有报错。

2、目前由于一些数据类型的原因，还未能识别带小数点类型的real型数字，下一步会进行调整。

3、目前的文法结构较为简单，不含复杂的语句，因此数据结构和语义动作相对不是非常复杂。

4、目前扫描器需要读到“#”最终停止，这有些不合理，下一步会对扫描器进行优化。



# 下一步计划

1、对已完成的代码进行优化扩充，对代码的规范性进行改进。

2、对扫描函数的功能进行改进，使扫描更加精确。

3、如果有需要的话，进行if-else或while语句语义动作的设计，当然这部分难度上升，需要先经过进一步学习。

